function sig_filtered = highpass(x, fc, bw, fs)
    filter = lowpass(x, fc, bw, fs);
    M = round(fs*4/bw);
    
    for i=1:N
        filter(i) = -1*filter(i);
    end
    filter(M/2+1) = filter(M/2+1) + 1;    

    sig_filtered = conv(x, filter);
    sig_filtered = (M/2+1:length(sig_filtered)-M/2+1)';
end